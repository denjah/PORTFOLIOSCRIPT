<!DOCTYPE html>
<html lang="ru" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=2560, height=1080">
    <title>Portfolio Layout Builder</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="bg-texture" class="bg-texture" aria-hidden="true"></div>
    <div class="app-container">
        <header class="app-header">
            <div class="header-left">
                <h1>üìê Portfolio Layout Builder</h1>
                <div class="theme-toggle">
                    <button type="button" class="theme-btn" id="themeLightBtn" onclick="toggleTheme('light')"
                        title="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞">‚òÄÔ∏è</button>
                    <button type="button" class="theme-btn" id="themeDarkBtn" onclick="toggleTheme('dark')"
                        title="–¢—ë–º–Ω–∞—è —Ç–µ–º–∞">üåô</button>
                </div>
                <div class="layout-selector-header">
                    <div class="radio-group radio-group-pills">
                        <label class="pill-label"><input type="radio" name="layout" value="0"
                                checked><span>1</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="1"><span>2</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="2"><span>3</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="3"><span>4</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="4"><span>4S</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="5"><span>3S</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="6"><span>8K</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="7"><span>9K</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="8"><span>10K</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="9"><span>41K</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="10"><span>ISO1</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="11"><span>ISO2</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="12"><span>ISO3</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="13"><span>P17</span></label>
                        <label class="pill-label"><input type="radio" name="layout" value="14"><span>P09</span></label>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <div class="control-row" style="margin-right: 15px; margin-bottom: 0;">
                    <label class="small-label" style="width: auto; margin-right: 5px;">Zoom</label>
                    <input type="range" id="previewZoomRange" min="10" max="200" value="100" style="width: 100px;">
                    <span id="previewZoomValue" class="range-value" style="width: 35px;">100%</span>
                </div>
                <button class="btn btn-accent btn-sm" id="exportPngBtn" disabled>
                    <span class="btn-icon">üì∑</span> PNG
                </button>
                <button class="btn btn-accent btn-sm" id="exportAllBtn" disabled>
                    <span class="btn-icon">üì¶</span> PNG All
                </button>
                <button class="btn btn-accent btn-sm" id="exportCurrentHtmlBtn" disabled>
                    <span class="btn-icon">üåê</span> HTML
                </button>
                <button class="btn btn-primary btn-sm" id="buildBtn" disabled>
                    <span class="btn-icon">‚ö°</span> HTML All
                </button>
            </div>
        </header>

        <main class="app-grid">
            <!-- LEFT SIDEBAR -->
            <aside class="sidebar-left">
                <!-- PRESETS BLOCK -->
                <section class="panel presets-panel collapsible-panel" id="presetsGroup">
                    <div class="panel-header toggle-header">
                        <h3 class="panel-title"><span class="toggle-icon">+</span> –ü—Ä–µ—Å–µ—Ç—ã –≤–∏–¥–∞</h3>
                    </div>
                    <div class="panel-content">
                        <div class="preset-controls" style="padding: 0 10px 10px 10px;">
                            <input type="text" id="presetNameInput" placeholder="–ò–º—è –ø—Ä–µ—Å–µ—Ç–∞..." class="input-sm"
                                style="margin-right:5px;">
                            <button id="btnSavePreset" class="btn btn-primary btn-sm">Save</button>
                        </div>
                        <div id="presetList" class="preset-list" style="margin: 0 10px 10px 10px;">
                            <div class="empty-msg">–ù–µ—Ç –ø—Ä–µ—Å–µ—Ç–æ–≤</div>
                        </div>
                    </div>
                </section>

                <!-- Upload & Project -->
                <section class="panel collapsible-panel" id="uploadSection">
                    <div class="panel-header toggle-header">
                        <h3 class="panel-title"><span class="toggle-icon">+</span> –ü—Ä–æ–µ–∫—Ç</h3>
                        <div class="panel-actions">
                            <button type="button" class="btn btn-ghost btn-xs" id="saveProjectBtn"
                                title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">üíæ</button>
                            <button type="button" class="btn btn-ghost btn-xs" id="loadProjectBtn"
                                title="–ó–∞–≥—Ä—É–∑–∏—Ç—å">üìÇ</button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="upload-zone" id="uploadZone">
                            <span class="upload-icon">üìÅ</span>
                            <span class="upload-label">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
                            <input type="file" id="fileInput" multiple accept="image/*">
                        </div>

                        <!-- Intro & Process Settings moved here -->
                        <div class="setting-group sg-intro mt-2">
                            <div class="setting-group-header">
                                <label class="label">–í—Å—Ç—É–ø–ª–µ–Ω–∏–µ</label>
                                <label class="toggle-wrap"><input type="checkbox" id="introEnabledToggle"
                                        class="module-toggle"> <span class="toggle-label">–≤–∫–ª</span></label>
                            </div>
                            <div class="intro-controls">
                                <input type="text" id="introTitleInput" class="input" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
                                <textarea id="introTextInput" class="textarea" placeholder="–¢–µ–∫—Å—Ç" rows="2"></textarea>
                                <div class="font-row">
                                    <select id="introFontSelect" class="select select-sm">
                                        <option value="'Helvetica Neue', Arial, sans-serif">Helvetica</option>
                                        <option value="Georgia, serif">Georgia</option>
                                    </select>
                                    <input type="number" id="introFontSizeInput" class="input input-num" value="48">
                                </div>
                            </div>
                        </div>

                        <div class="setting-group sg-process mt-2">
                            <div class="setting-group-header">
                                <label class="label">–ü—Ä–æ—Ü–µ—Å—Å</label>
                                <label class="toggle-wrap"><input type="checkbox" id="processEnabledToggle"
                                        class="module-toggle"> <span class="toggle-label">–≤–∫–ª</span></label>
                            </div>
                            <div class="process-controls">
                                <input type="text" id="processSectionTitleInput" class="input"
                                    placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏">
                                <div class="font-row">
                                    <select id="processFontSelect" class="select select-sm">
                                        <option value="'Helvetica Neue', Arial, sans-serif">Helvetica</option>
                                    </select>
                                    <input type="number" id="processFontSizeInput" class="input input-num" value="18">
                                </div>
                                <div class="process-image-row">
                                    <label class="btn btn-outline btn-xs">Img <input type="file" id="processImageInput"
                                            accept="image/*" class="sr-only"></label>
                                    <span id="processImageName" class="hint"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Cards -->
                <section class="panel cards-panel collapsible-panel expanded" id="cardsSection">
                    <div class="panel-header toggle-header">
                        <h3 class="panel-title"><span class="toggle-icon">-</span> –ö–∞—Ä—Ç–æ—á–∫–∏</h3>
                        <button type="button" class="btn btn-ghost btn-xs" id="clearCardsBtn">üóëÔ∏è</button>
                    </div>
                    <div class="panel-content" style="display:block;">
                        <!-- Dynamic height, no scroll container, fit all -->
                        <div class="cards-list" id="cardsList"></div>
                    </div>
                </section>
            </aside>

            <!-- CENTER PREVIEW -->
            <section class="preview-area">
                <div class="canvas-container" id="canvasContainer">
                    <canvas id="previewCanvas"></canvas>
                </div>
            </section>

            <!-- RIGHT SIDEBAR -->
            <aside class="sidebar-right">
                <!-- Layout Settings -->
                <section class="panel settings-panel">
                    <h3 class="panel-title visually-hidden">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–∫–µ—Ç–∞</h3>

                    <!-- Aspect & Frame -->
                    <div class="setting-group collapsible-group expanded">
                        <div class="group-header toggle-header"><span class="toggle-icon">-</span> –ú–∞–∫–µ—Ç –∏ –†–∞–º–∫–∞</div>
                        <div class="group-content" style="display:block;">
                            <!-- Aspect ratio -->
                            <div class="control-row">
                                <label class="small-label">–ü—Ä–æ–ø–æ—Ä—Ü–∏—è</label>
                                <div class="radio-group radio-group-pills">
                                    <label class="pill-label"><input type="radio" name="aspect" value="1"
                                            checked><span>1:1</span></label>
                                    <label class="pill-label"><input type="radio" name="aspect"
                                            value="0.75"><span>3:4</span></label>
                                </div>
                            </div>
                            <!-- Frame -->
                            <div class="control-row">
                                <label class="small-label">–†–∞–º–∫–∞</label>
                                <div class="radio-group radio-group-pills">
                                    <label class="pill-label"><input type="radio" name="frame" value="white"
                                            checked><span>W</span></label>
                                    <label class="pill-label"><input type="radio" name="frame"
                                            value="black"><span>B</span></label>
                                </div>
                                <input type="number" id="frameSizeInput" class="input input-num" value="2" min="0"
                                    max="20" step="1" title="–†–∞–∑–º–µ—Ä —Ä–∞–º–∫–∏">
                            </div>
                        </div>
                    </div>

                    <!-- Standard Layout Controls -->
                    <div class="setting-group sg-standard-controls collapsible-group expanded" id="stdControlsGroup">
                        <div class="group-header toggle-header"><span class="toggle-icon">-</span> –°–µ—Ç–∫–∞ (Standard)
                        </div>
                        <div class="group-content" style="display:block;">
                            <!-- Content Margin -->
                            <div class="control-row">
                                <label class="small-label">–ü–æ–ª—è</label>
                                <input type="range" id="contentMarginRange" min="0" max="400" value="100"
                                    class="range-sm">
                                <span id="contentMarginValue" class="range-value">100</span>
                            </div>

                            <!-- Column Gap -->
                            <div class="control-row">
                                <label class="small-label">Gap</label>
                                <input type="range" id="columnGapRange" min="0" max="200" value="40" class="range-sm">
                                <span id="columnGapValue" class="range-value">40</span>
                            </div>

                            <!-- Vertical Align -->
                            <div class="control-row">
                                <label class="small-label">Align</label>
                                <div class="radio-group radio-group-pills">
                                    <label class="pill-label"><input type="radio" name="vertAlign"
                                            value="top"><span>T</span></label>
                                    <label class="pill-label"><input type="radio" name="vertAlign" value="center"
                                            checked><span>C</span></label>
                                    <label class="pill-label"><input type="radio" name="vertAlign"
                                            value="bottom"><span>B</span></label>
                                </div>
                            </div>

                            <!-- 3D Rotation for Standard -->
                            <div class="control-row"
                                style="margin-top:10px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px;">
                                <div
                                    style="display:flex; justify-content:space-between; width:100%; margin-bottom:5px;">
                                    <span class="small-label" style="opacity:0.7">3D Rotation</span>
                                    <button id="btnResetStdRotation" class="btn-xs btn-yellow"
                                        title="–°–±—Ä–æ—Å–∏—Ç—å">‚ü≤</button>
                                </div>
                            </div>
                            <div class="control-row">
                                <label class="small-label">3D X</label>
                                <input type="range" id="stdRotXRange" min="-180" max="180" value="0" class="range-sm">
                                <span id="stdRotXValue" class="range-value">0¬∞</span>
                            </div>
                            <div class="control-row">
                                <label class="small-label">3D Y</label>
                                <input type="range" id="stdRotYRange" min="-180" max="180" value="0" class="range-sm">
                                <span id="stdRotYValue" class="range-value">0¬∞</span>
                            </div>
                            <div class="control-row">
                                <label class="small-label">3D Z</label>
                                <input type="range" id="stdRotZRange" min="-180" max="180" value="0" class="range-sm">
                                <span id="stdRotZValue" class="range-value">0¬∞</span>
                            </div>
                        </div>
                    </div>

                    <!-- Pattern Controls (P17/P09) -->
                    <div class="setting-group collapsible-group expanded" id="patternSettingsGroup"
                        style="display:none;">
                        <div class="group-header toggle-header"><span class="toggle-icon">-</span> –ü–∞—Ç—Ç–µ—Ä–Ω</div>
                        <div class="group-content" style="display:block;">
                            <div class="control-row">
                                <button id="btnRandomizePattern" class="btn btn-primary btn-xs"
                                    style="width:100%">Randomize Pattern üé≤</button>
                            </div>
                        </div>
                    </div>

                    <!-- ISO Settings -->
                    <div class="setting-group sg-iso-settings collapsible-group expanded" id="isoSettingsGroup"
                        style="display:none;">
                        <div class="group-header toggle-header"><span class="toggle-icon">-</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ISO</div>
                        <div class="group-content" style="display:block;">
                            <!-- Lens (Perspective) -->
                            <div class="control-row">
                                <label class="small-label">–û–±—ä–µ–∫—Ç–∏–≤</label>
                                <input type="range" id="isoLensRange" min="12" max="800" value="50" class="range-sm">
                                <span id="isoLensValue" class="range-value">50mm</span>
                            </div>

                            <!-- Angle -->
                            <div class="control-row">
                                <label class="small-label">–£–≥–æ–ª</label>
                                <input type="range" id="isoAngleRange" min="-45" max="45" value="0" class="range-sm">
                                <span id="isoAngleValue" class="range-value">0¬∞</span>
                            </div>

                            <!-- View Angle -->
                            <div class="control-row">
                                <label class="small-label">–ù–∞–∫–ª–æ–Ω</label>
                                <input type="range" id="isoViewAngleRange" min="10" max="80" value="30"
                                    class="range-sm">
                                <span id="isoViewAngleValue" class="range-value">30¬∞</span>
                            </div>

                            <!-- Scale / Spacing -->
                            <div class="control-row">
                                <label class="small-label">–ú–∞—Å—à—Ç–∞–±</label>
                                <input type="range" id="isoScaleRange" min="20" max="200" value="100" class="range-sm">
                                <span id="isoScaleValue" class="range-value">100%</span>
                            </div>
                            <div class="control-row">
                                <label class="small-label">–û—Ç—Å—Ç—É–ø</label>
                                <input type="range" id="isoSpacingRange" min="50" max="300" value="100"
                                    class="range-sm">
                                <span id="isoSpacingValue" class="range-value">100%</span>
                            </div>

                            <!-- Z-Interval (Depth Scale) -->
                            <div class="control-row">
                                <label class="small-label">Z-Dist</label>
                                <input type="range" id="isoZIntervalRange" min="1" max="100" value="20"
                                    class="range-sm">
                                <span id="isoZIntervalValue" class="range-value">20</span>
                            </div>

                            <!-- Card Rotation -->
                            <div style="margin-top:10px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px;">
                                <div style="display:flex; justify-content:space-between;">
                                    <label class="small-label">–í—Ä–∞—â–µ–Ω–∏–µ</label>
                                    <button id="btnResetRotation" class="btn-xs btn-yellow" title="–°–±—Ä–æ—Å–∏—Ç—å">‚ü≤</button>
                                </div>
                                <div class="control-row"><label class="small-label">X</label><input type="range"
                                        id="isoRotXRange" min="-180" max="180" value="0" class="range-sm"><span
                                        id="isoRotXValue" class="range-value">0¬∞</span></div>
                                <div class="control-row"><label class="small-label">Y</label><input type="range"
                                        id="isoRotYRange" min="-180" max="180" value="0" class="range-sm"><span
                                        id="isoRotYValue" class="range-value">0¬∞</span></div>
                                <div class="control-row"><label class="small-label">Z</label><input type="range"
                                        id="isoRotZRange" min="-180" max="180" value="0" class="range-sm"><span
                                        id="isoRotZValue" class="range-value">0¬∞</span></div>
                            </div>

                            <!-- DOF -->
                            <div style="margin-top:10px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px;">
                                <label class="small-label">DoF (–†–∞–∑–º—ã—Ç–∏–µ)</label>
                                <div class="control-row"><label class="small-label">Aperture</label><input type="range"
                                        id="isoApertureRange" min="0" max="20" value="0" step="0.5"
                                        class="range-sm"><span id="isoApertureValue" class="range-value">0</span></div>
                                <div class="control-row"><label class="small-label">Focus</label><input type="range"
                                        id="isoFocusPosRange" min="0" max="100" value="50" class="range-sm"><span
                                        id="isoFocusPosValue" class="range-value">50%</span></div>
                                <div class="control-row"><label class="small-label">Zone</label><input type="range"
                                        id="isoFocusWidthRange" min="0" max="50" value="10" class="range-sm"><span
                                        id="isoFocusWidthValue" class="range-value">10</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Shadows -->
                    <div class="setting-group collapsible-group expanded">
                        <div class="group-header toggle-header"><span class="toggle-icon">-</span> –¢–µ–Ω–∏</div>
                        <div class="group-content" style="display:block;">
                            <div class="control-row">
                                <label class="small-label">–°–¥–≤–∏–≥ Y (V)</label>
                                <input type="range" id="shadowDistRange" min="0" max="100" value="20" class="range-sm">
                                <span id="shadowDistValue" class="range-value">20</span>
                            </div>
                            <div class="control-row">
                                <label class="small-label">–°–¥–≤–∏–≥ X (H)</label>
                                <input type="range" id="shadowDistXRange" min="-100" max="100" value="0"
                                    class="range-sm">
                                <span id="shadowDistXValue" class="range-value">0</span>
                            </div>
                            <div class="control-row">
                                <label class="small-label">–†–∞–∑–º—ã—Ç–∏–µ</label>
                                <input type="range" id="shadowBlurRange" min="0" max="100" value="40" class="range-sm">
                                <span id="shadowBlurValue" class="range-value">40</span>
                            </div>
                            <div class="control-row">
                                <label class="small-label">–û–ø–∞—Å–∏—Ç–∏</label>
                                <input type="range" id="shadowOpacityRange" min="0" max="100" value="40"
                                    class="range-sm">
                                <span id="shadowOpacityValue" class="range-value">40%</span>
                            </div>

                            <!-- Shadow Presets -->
                            <div class="control-row"
                                style="margin-top:10px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px;">
                                <div
                                    style="display:flex; justify-content:space-between; width:100%; margin-bottom:5px;">
                                    <span class="small-label" style="opacity:0.7">–ü—Ä–µ—Å–µ—Ç—ã</span>
                                    <div style="display:flex; gap:5px;">
                                        <button id="btnAddShadowPreset" class="btn-xs btn-outline"
                                            title="–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ç–µ–Ω—å">+</button>
                                        <button id="btnResetShadows" class="btn-xs btn-yellow"
                                            title="–°–±—Ä–æ—Å–∏—Ç—å">‚ü≤</button>
                                    </div>
                                </div>
                            </div>
                            <div id="shadowPresetsList" class="preset-list"
                                style="max-height:none; background:transparent; padding:0; gap:5px; flex-wrap:wrap; display:flex;">
                                <!-- Presets injected by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Background -->
                    <div class="setting-group collapsible-group expanded">
                        <div class="group-header toggle-header"><span class="toggle-icon">-</span> –§–æ–Ω</div>
                        <div class="group-content" style="display:block;">
                            <div class="bg-controls">
                                <div class="radio-group radio-group-pills">
                                    <label class="pill-label"><input type="radio" name="bg" value="random"
                                            checked><span>Rand</span></label>
                                    <button type="button" class="btn btn-outline btn-xs" id="customBgBtn">–°–≤–æ–π</button>
                                </div>
                                <select id="bgHistorySelect" class="select select-sm">
                                    <option value="">–ò—Å—Ç–æ—Ä–∏—è</option>
                                </select>
                                <button type="button" class="btn btn-ghost btn-xs" id="bgRandomizeBtn"
                                    title="–†–∞–Ω–¥–æ–º">üé≤</button>
                                <input type="file" id="bgInput" accept="image/*" class="sr-only">
                                <div class="bg-drop-zone" id="bgDropZone"><span class="drop-text">Drop BG Here</span>
                                </div>
                            </div>
                            <!-- ISO BG controls if needed, can share or be separate. keeping simple for now -->
                            <div id="isoBgControls"
                                style="display:none; margin-top:10px; border-top:1px solid rgba(255,255,255,0.1); padding-top:5px;">
                                <label class="small-label">ISO –§–æ–Ω</label>
                                <button type="button" class="btn btn-outline btn-xs" id="isoBgBtn"
                                    style="width:100%; margin-bottom:5px;">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
                                <div class="control-row">
                                    <label class="small-label">Blur</label>
                                    <input type="range" id="isoBgBlurRange" min="0" max="40" value="20"
                                        class="range-sm">
                                    <span id="isoBgBlurValue" class="range-value">20</span>
                                </div>
                                <input type="file" id="isoBgInput" accept="image/*" class="sr-only">
                            </div>
                        </div>
                    </div>

                    <!-- Icons -->
                    <div class="setting-group collapsible-group">
                        <div class="group-header toggle-header"><span class="toggle-icon">+</span> –ò–∫–æ–Ω–∫–∏</div>
                        <div class="group-content">
                            <label class="toggle-wrap"><input type="checkbox" id="iconsEnabledToggle" checked
                                    class="module-toggle"> <span class="toggle-label">–≤–∫–ª</span></label>
                            <div class="icon-options mt-2">
                                <select id="iconThemeSelect" class="select">
                                    <option value="png_black">PNG_BLACK</option>
                                    <option value="svg_black">SVG_BLACK</option>
                                    <option value="svg_white">SVG_WHITE</option>
                                </select>
                                <div class="row-center mt-2"><button type="button" class="btn btn-sm btn-outline"
                                        id="iconRandomPlaceBtn">Pos</button><button type="button"
                                        class="btn btn-sm btn-outline" id="iconRandomItemBtn">Item</button></div>
                                <div class="mt-2"><label class="small-label">–û–ø–∞—Å–∏—Ç–∏ <span
                                            id="iconOpacityValue">30%</span></label><input type="range"
                                        id="iconOpacityRange" min="0" max="100" value="30" class="range-sm"></div>
                                <button type="button" class="btn btn-outline btn-xs mt-2"
                                    id="loadIconsBtn">Load</button>
                            </div>
                        </div>
                    </div>

                </section>
            </aside>
        </main>
    </div>

    <script src="script.js"></script>
</body>

</html>